{% extends "recipes/base.html" %}

{% block title %}Recipes{% endblock %}

{% block content %}

<div class="page-header">
    <h1>Recipes</h1>
    <a href="{% url 'recipe_create' %}" class="btn btn-primary">+ Add Recipe</a>
</div>
<p class="page-subtitle">{{ recipes|length }} recipe{{ recipes|length|pluralize }} in your collection</p>

<form class="search-form" method="get" action="{% url 'recipe_list' %}">
    <input type="text" name="q" value="{{ query }}" placeholder="Search recipes...">
    <button type="submit" class="btn btn-primary">Search</button>
    {% if query %}<a href="{% url 'recipe_list' %}" class="btn btn-secondary">Clear</a>{% endif %}
</form>

{% if query %}
    <p class="meta">Showing results for "{{ query }}" ({{ recipes|length }} found)</p>
{% endif %}

{% for recipe in recipes %}
<div class="card" style="display: flex; gap: 1rem; align-items: flex-start;">
    {% if recipe.image %}
    <img src="{{ recipe.image.url }}" alt="{{ recipe.title }}" class="card-img">
    {% else %}
    <div class="card-img-placeholder">&#127860;</div>
    {% endif %}
    <div>
    <h2><a href="{% url 'recipe_detail' recipe.slug %}">{{ recipe.title }}</a></h2>
    <p class="meta">
        {% if recipe.category %}<span class="badge">{{ recipe.category.name }}</span>{% endif %}
        {% if recipe.calories %}<span class="badge">{{ recipe.calories }} cal</span>{% endif %}
        {{ recipe.prep_time }} min prep &middot; {{ recipe.cook_time }} min cook &middot; {{ recipe.servings }} serving{{ recipe.servings|pluralize }}
    </p>
    {% if recipe.description %}<p>{{ recipe.description|truncatewords:30 }}</p>{% endif %}
    </div>
</div>
{% empty %}
<div class="card">
    <p>No recipes found. <a href="{% url 'recipe_create' %}">Add your first recipe!</a></p>
</div>
{% endfor %}
{% endblock %}

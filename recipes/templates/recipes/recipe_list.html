{% extends "recipes/base.html" %}

{% block title %}Recipes{% endblock %}

{% block content %}

<div class="card" style="border-top-color: #d4853b; text-align: center; padding: 1.5rem 2rem;">
    <h2 style="margin-bottom: 0.3rem;">Flow & Flourish</h2>
    <p style="font-style: italic; color: #8a7e72; margin-bottom: 0.8rem;">Where culinary passion meets code</p>
    <p style="font-size: 0.95rem; max-width: 640px; margin: 0 auto 0.6rem;">
        Created by <strong>Melanie Mann</strong>, a Le Cordon Bleu (Orlando, FL) trained chef with 25 years of experience across the culinary industry. Melanie went back to school to build an easy, user-friendly software designed for home use and start-up companies.
    </p>
    <p class="meta">Established February 9, 2026</p>
</div>

{% if urgent_items %}
<div class="alert-banner {% if urgent_items.0.status == 'expired' or urgent_items.0.status == 'today' %}alert-banner-danger{% else %}alert-banner-warning{% endif %}">
    <strong>Pantry Alert:</strong> You have items expiring soon!
    <ul>
        {% for item in urgent_items %}
        <li>
            <strong>{{ item.name }}</strong>{% if item.quantity %} ({{ item.quantity }}){% endif %}
            &mdash; <span class="status-badge status-{{ item.status }}">{{ item.status_label }}</span>
        </li>
        {% endfor %}
    </ul>
    <p style="margin-top: 0.5rem;"><a href="{% url 'pantry_list' %}">View pantry &rarr;</a></p>
</div>
{% endif %}

<div class="page-header">
    <h1>Recipes</h1>
    <a href="{% url 'recipe_create' %}" class="btn btn-primary">+ Add Recipe</a>
</div>
<p class="page-subtitle">{{ recipes|length }} recipe{{ recipes|length|pluralize }} in your collection</p>

<form class="search-form" method="get" action="{% url 'recipe_list' %}">
    <input type="text" name="q" value="{{ query }}" placeholder="Search recipes...">
    <button type="submit" class="btn btn-primary">Search</button>
    {% if query %}<a href="{% url 'recipe_list' %}" class="btn btn-secondary">Clear</a>{% endif %}
</form>

{% if query %}
    <p class="meta">Showing results for "{{ query }}" ({{ recipes|length }} found)</p>
{% endif %}

{% for recipe in recipes %}
<div class="card" style="display: flex; gap: 1rem; align-items: flex-start;">
    {% if recipe.image %}
    <img src="{{ recipe.image.url }}" alt="{{ recipe.title }}" class="card-img">
    {% else %}
    <div class="card-img-placeholder">&#127860;</div>
    {% endif %}
    <div>
    <h2><a href="{% url 'recipe_detail' recipe.slug %}">{{ recipe.title }}</a></h2>
    <p class="meta">
        {% if recipe.category %}<span class="badge">{{ recipe.category.name }}</span>{% endif %}
        {% if recipe.calories %}<span class="badge">{{ recipe.calories }} cal</span>{% endif %}
        {{ recipe.prep_time }} min prep &middot; {{ recipe.cook_time }} min cook &middot; {{ recipe.servings }} serving{{ recipe.servings|pluralize }}
    </p>
    {% if recipe.description %}<p>{{ recipe.description|truncatewords:30 }}</p>{% endif %}
    </div>
</div>
{% empty %}
<div class="card">
    <p>No recipes found. <a href="{% url 'recipe_create' %}">Add your first recipe!</a></p>
</div>
{% endfor %}
{% endblock %}
